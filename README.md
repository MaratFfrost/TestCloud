# Cloud Storage Marketplace

–¢–µ—Å—Ç–æ–≤–æ–µ –∑–∞–¥–∞–Ω–∏–µ ‚Äî –∞–≥—Ä–µ–≥–∞—Ç–æ—Ä —Ç–∞—Ä–∏—Ñ–Ω—ã—Ö –ø–ª–∞–Ω–æ–≤ –æ–±–ª–∞—á–Ω–æ–≥–æ —Ö—Ä–∞–Ω–µ–Ω–∏—è —Å –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å—é –æ—Ñ–æ—Ä–º–ª–µ–Ω–∏—è –∑–∞–∫–∞–∑–∞.

## –û–ø–∏—Å–∞–Ω–∏–µ

* **/plans** ‚Äî –ø–æ–ª—É—á–µ–Ω–∏–µ –∞–≥—Ä–µ–≥–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö —Ç–∞—Ä–∏—Ñ–æ–≤ –¥–≤—É—Ö –ø—Ä–æ–≤–∞–π–¥–µ—Ä–æ–≤ (—á—Ç–µ–Ω–∏–µ –∏–∑ JSON-—Ñ–∞–π–ª–æ–≤)
* **/orders** ‚Äî –æ—Ñ–æ—Ä–º–ª–µ–Ω–∏–µ –∑–∞–∫–∞–∑–∞ –Ω–∞ —Ç–∞—Ä–∏—Ñ, –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ —Å—Ç–∞—Ç—É—Å–∞ (pending ‚Üí complete)
* –ú–æ–¥–µ–ª–∏ ‚Äî Pydantic
* –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è ‚Äî Swagger/OpenAPI
* –¢–µ—Å—Ç—ã ‚Äî pytest, httpx
* –•—Ä–∞–Ω–µ–Ω–∏–µ –∑–∞–∫–∞–∑–æ–≤ ‚Äî –≤ –ø–∞–º—è—Ç–∏ (in-memory)
* –≠–º—É–ª—è—Ü–∏—è –≤–Ω–µ—à–Ω–∏—Ö –ø—Ä–æ–≤–∞–π–¥–µ—Ä–æ–≤

---

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
app/
‚îÇ
‚îú‚îÄ‚îÄ api/                # –†–æ—É—Ç—ã FastAPI
‚îÇ   ‚îú‚îÄ‚îÄ orders.py
‚îÇ   ‚îî‚îÄ‚îÄ pricing_plans.py
‚îÇ
‚îú‚îÄ‚îÄ models/             # Pydantic-–º–æ–¥–µ–ª–∏
‚îÇ   ‚îú‚îÄ‚îÄ order.py
‚îÇ   ‚îî‚îÄ‚îÄ pricing_plans.py
‚îÇ
‚îú‚îÄ‚îÄ tasks/              # Background –∑–∞–¥–∞—á–∏
‚îÇ   ‚îî‚îÄ‚îÄ order.py
‚îÇ
‚îú‚îÄ‚îÄ utils/              # –í—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã–µ –º–æ–¥—É–ª–∏
‚îÇ   ‚îî‚îÄ‚îÄ storage.py
‚îÇ
‚îú‚îÄ‚îÄ tests/              # –¢–µ—Å—Ç—ã (pytest)
‚îÇ   ‚îú‚îÄ‚îÄ conftest.py
‚îÇ   ‚îî‚îÄ‚îÄ unit_tests/
‚îÇ
‚îú‚îÄ‚îÄ main.py             # –¢–æ—á–∫–∞ –≤—Ö–æ–¥–∞ FastAPI
‚îÇ
‚îú‚îÄ‚îÄ Dockerfile          # Docker –¥–ª—è –ø—Ä–æ–¥–∞–∫—à–Ω
‚îú‚îÄ‚îÄ Dockerfile.dev      # Docker –¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏
‚îú‚îÄ‚îÄ requirements.txt    # –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
‚îú‚îÄ‚îÄ docker-compose.yaml
‚îú‚îÄ‚îÄ docker-compose.redis.yml
‚îî‚îÄ‚îÄ pytest.ini
```

---

## üöÄ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç —á–µ—Ä–µ–∑ Docker

1. **–ó–∞–ø—É—Å—Ç–∏ Redis:**

   ```bash
   docker-compose -f docker-compose.redis.yml up -d
   ```

2. **–ó–∞–ø—É—Å—Ç–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ:**

   ```bash
   docker-compose up --build -d
   ```

3. **–°–µ—Ä–≤–∏—Å –±—É–¥–µ—Ç –¥–æ—Å—Ç—É–ø–µ–Ω –ø–æ –∞–¥—Ä–µ—Å—É:**

   * –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ: [http://localhost:7788](http://localhost:7788)
   * –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è: [http://localhost:7788/docs](http://localhost:7788/docs)

---

## üìö –≠–Ω–¥–ø–æ–∏–Ω—Ç—ã

### –ü–æ–ª—É—á–∏—Ç—å —Ç–∞—Ä–∏—Ñ–Ω—ã–µ –ø–ª–∞–Ω—ã

```http
GET /plans?min_storage=50
```

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:**

* `min_storage` ‚Äî –º–∏–Ω–∏–º–∞–ª—å–Ω—ã–π –æ–±—ä–µ–º (–ì–ë), –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é 0

**–û—Ç–≤–µ—Ç:**
–°–ø–∏—Å–æ–∫ —Ç–∞—Ä–∏—Ñ–æ–≤ (–∞–≥—Ä–µ–≥–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –∏ –æ—Ç—Å–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –ø–æ –ø–æ–ª–Ω–æ–π —Å—Ç–æ–∏–º–æ—Å—Ç–∏).

---

### –û—Ñ–æ—Ä–º–∏—Ç—å –∑–∞–∫–∞–∑

```http
POST /orders
```

**–ü—Ä–∏–º–µ—Ä –∑–∞–ø—Ä–æ—Å–∞:**

```json
{
  "provider": "A",
  "storage_gb": 100
}
```

**–û—Ç–≤–µ—Ç:**

```json
{
  "order_id": "...",
  "status": "pending"
}
```

---

### –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å—Ç–∞—Ç—É—Å –∑–∞–∫–∞–∑–∞

```http
GET /orders/{order_id}
```

**–û—Ç–≤–µ—Ç:**

```json
{
  "order_id": "...",
  "status": "pending" | "complete"
}
```

---

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

```bash
pytest
```

---

## üíª –õ–æ–∫–∞–ª—å–Ω—ã–π –∑–∞–ø—É—Å–∫ (–±–µ–∑ Docker)

1. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏:

   ```bash
   python -m venv venv
   source venv/bin/activate  # –¥–ª—è Windows: venv\Scripts\activate
   pip install -r requirements.txt
   ```

2. –ó–∞–ø—É—Å—Ç–∏—Ç—å Redis (–Ω–∞–ø—Ä–∏–º–µ—Ä, —á–µ—Ä–µ–∑ Docker):

   ```bash
   docker-compose -f docker-compose.redis.yml up -d
   ```

3. –ò–∑–º–µ–Ω–∏ –≤ `main.py` —Å—Ç—Ä–æ–∫—É –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –Ω–∞:

   ```python
   redis_url = "redis://localhost:6379"
   ```

   *(–∏–ª–∏ –æ—Å—Ç–∞–≤—å REDIS\_HOST=localhost, –µ—Å–ª–∏ –±–µ—Ä—ë—à—å –∏–∑ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö —Å—Ä–µ–¥—ã)*

4. –ó–∞–ø—É—Å—Ç–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ:

   ```bash
   uvicorn app.main:app --reload --port 7788
   ```

---

## üîé –ü—Ä–∏–º–µ—Ä—ã —Ä–∞–±–æ—Ç—ã

**–ü–æ–ª—É—á–∏—Ç—å —Ç–∞—Ä–∏—Ñ—ã**

```
GET http://localhost:7788/plans?min_storage=50
```

**–û—Ñ–æ—Ä–º–∏—Ç—å –∑–∞–∫–∞–∑**

```
POST http://localhost:7788/orders
Body: { "provider": "A", "storage_gb": 100 }
```

**–ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∑–∞–∫–∞–∑**

```
GET http://localhost:7788/orders/{order_id}
```

---

